---
import { hero, site } from '../data/portfolio';
const base = import.meta.env.BASE_URL.replace(/\/?$/, '/');
const resolveAsset = (path: string) => `${base}${path.replace(/^\//, '')}`;
---

<aside
  data-animation="default"
  data-collapse="medium"
  data-duration="400"
  data-easing="ease"
  data-easing2="ease"
  role="banner"
  class="sidebar w-nav"
>
  <div class="nav-content">
    <a href="#home" class="w-nav-brand" aria-label="home">
      <div class="niv-data">
        <img src={resolveAsset('/assets/profile-placeholder.svg')} loading="eager" alt="Manan Mehta profile placeholder" class="niv-image" />
        <div>
          <div class="label-white">{site.shortTitle}</div>
          <div class="label-gray">{site.roleLabel}</div>
        </div>
      </div>
    </a>

    <nav role="navigation" class="w-nav-menu">
      <a href="#home" class="nav-link-container w-inline-block"><img src={resolveAsset('/assets/home.svg')} loading="eager" alt="" class="nav-link-image" /><div>Home</div></a>
      <a href="#about" class="nav-link-container w-inline-block"><img src={resolveAsset('/assets/code.svg')} loading="eager" alt="" class="nav-link-image" /><div>About</div></a>
      <a href="#skills" class="nav-link-container w-inline-block"><img src={resolveAsset('/assets/browser.svg')} loading="eager" alt="" class="nav-link-image" /><div>Skills</div></a>
      <a href="#experience" class="nav-link-container w-inline-block"><img src={resolveAsset('/assets/dns.svg')} loading="eager" alt="" class="nav-link-image" /><div>Experience</div></a>
      <a href="#projects" class="nav-link-container w-inline-block"><img src={resolveAsset('/assets/favorite.svg')} loading="eager" alt="" class="nav-link-image" /><div>Projects</div></a>
      <a href="#education" class="nav-link-container w-inline-block"><img src={resolveAsset('/assets/database.svg')} loading="eager" alt="" class="nav-link-image" /><div>Education</div></a>
      <a href="#contact" class="nav-link-container w-inline-block"><img src={resolveAsset('/assets/browser.svg')} loading="eager" alt="" class="nav-link-image" /><div>Contact</div></a>
    </nav>

    <div class="sidebar-quick-actions">
      <a class="button w-button" href={hero.ctas.cv} download>Download CV</a>
    </div>

    <div class="navbar-icon-button w-nav-button" style="-webkit-user-select: text;" aria-label="menu" role="button" tabindex="0">
      <img src={resolveAsset('/assets/menu.svg')} loading="eager" alt="" class="navbar-icon" />
    </div>
  </div>

  <script>
    import { setupNav } from '../scripts/nav.js';

    let cleanup;
    document.addEventListener('astro:page-load', () => {
      if (cleanup) cleanup();
      cleanup = setupNav();
    });

    document.addEventListener('astro:before-swap', () => {
      if (cleanup) cleanup();
    });
  </script>
</aside>
